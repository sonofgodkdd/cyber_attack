Yahoo! PH Purple Hunt 2.0 Ad Compromised !
Mohit Kumar
Yahoo! PH Purple Hunt 2.0 Ad Compromised !
Earlier the other day, I was browsing through the Yahoo! PH site and the Yahoo! Purple Hunt 2.0 ad caught my attention.
Curious as I am, I clicked on the ad and surprisingly my browser downloaded a suspicious file named com.com.
Apparently this ad redirected me to a randomly generated URL similar to the following which, unfortunately, led to the malicious download:
hxxp://want6.{BLOCKED}.com/se/3da19bea8f9c03e96c9b1acad9cce5a88a2244f0a34d69
c09b8d3198b2797726789be0228c0df3c762ed088a2327b07f4a183fa6fa753b0acfd7f0afc2d2b
13b801ba978269fcda413f53e/960b0a2a/com.com
hxxp://nose8.{BLOCKED}.com/se/3da19bea8f9c03e96c9b1acad9cce5a88a2244f0a34d69c
09b8d3198b2797726789be0228c0df3c762ed088a2327b07f4a183fa6fa753b0acfd7f0afc2d2b
13b801ba978269fcda413f53e/960b0a2a/com.com
hxxp://letter6.{BLOCKED}.com/se/3da19bea8f9c03e96c9b1acad9cce5a88a2244f0a34d69c0
9b8d3198b2797726789be0228c0f3c762ed088a2327b07f4a183fa6fa753b0acfd7f0afc2d2b13
b801ba978269fcda413f53e/785c08d8/com.com
Below is a screenshot of the file download dialog box:
The downloaded file is detected by Trend Micro as TSPY_PIRMINAY.A. Let’s see how the download took place.
Firstly, the download only happens once per browser, which means that the malvertisement may have used an IP and user agent filtering of some sort to prevent multiple downloads which would make it suspicious to the end user.
To be able to replicate the malware download from the compromised ad, we used a browser extension which spoofs browser user agents, instead of installing different browsers.
It appears that the advertisement is first redirected to the malware download before it finally brings the browser to the real advertisement page. The redirection follows this format for the download link:
http://{varying string}{random number}.{varying domain}/se/{constant string or guid}/com.com
We’d like to thank the guys over at Yahoo! Ad Security Ops for acting swiftly on our initial report, taking down the malvertisement so it could no longer harm unsuspecting users.
Source
Have something to say about this article? Comment below or share it with us on Facebook, Twitter or our LinkedIn Group.
